<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="./CSS/Principal.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <title>Proceso Compra</title>
</head>

<body>
  <!-- Navegador -->
  <nav class="container-fluid" id="navegador" >
    <div  class="navbar nav justify-content-center" data-bs-theme="dark">
    <h3 class="tituloNav">ESTUDIO MAGIAS</h3> 
      <ul class="nav justify-content-center">
        <li class="nav-item">
          <a class="nav-link" href="./index.html" onclick="limpiarCarrito();">Inicio </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./ProductosServicios.html" onclick="limpiarCarrito();">Productos y Servicios</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="./ProcesoCompra.html" onclick="limpiarCarrito();">Proceso de Compra</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./Contacto.html" onclick="limpiarCarrito();">Contacto</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./PreguntasFrecuentes.html" onclick="limpiarCarrito();">Preguntas Frecuentes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./AcercaDe.html" onclick="limpiarCarrito();">Acerca De</a>
        </li>
      </ul>
    </div>
  </nav>
  <!-- Fin  Navegador -->
  <main class="container-fluid p-3">
<h1>FACTURA</h1>

<div class="card container text-center" style="max-width: 70%; margin-bottom: 5%; border: 1px solid black;">
  <div class="card-header">
    ESTUDIO MAGIAS
  </div>
  <div class="card-body">
    <!-- <h5 class="card-title">Special title treatment</h5> -->
    <div class="table-responsive" style="min-width: 100%;">
      <table class="table table-striped">
        <thead>
          <tr>
              <th>Nombre</th>
              <th>Cantidad</th>
              <th>Precio</th>
              <th>Subtotal</th>
          </tr>
      </thead>
      <tbody id="detalle">
        <!-- Los datos de la tabla se añaden aquí -->
      </tbody>
      
      </table>
      <!-- <a href="#" class="btn btn-primary">Go somewhere</a> -->
    </div>
    <h3>Tipo de envío: <span id="TipoEnvio"></span></h3>
    <h3>Costo de envío: <span id="costoEnvio"></span></h3>
    <h3>Total: <span id="mostrar-total"></span></h3>
  </div>
</div>



    <nav aria-label="Page navigation example">
      <ul class="pagination justify-content-center">
        <li class="page-item ">
          <a class="page-link " href="#" ><i class="bi bi-chevron-double-left"></i></a>
        </li>
        <li class="page-item"><a class="page-link" href="#">1</a></li>
        <li class="page-item"><a class="page-link" href="#">2</a></li>
        <li class="page-item active"><a class="page-link" href="./Factura.html">3</a></li>
        <li class="page-item">
          <a class="page-link" href="./Factura.html"><i class="bi bi-chevron-double-right"></i></a>
        </li>
      </ul>
    </nav>
  </main>

  <!-- Footer inicio -->
  <footer>      
    <div class="container-fluid">
  <h4>Contáctenos</h4>
      <a href="https://www.facebook.com/osvaldoquesadafotografo?mibextid=ZbWKwL"><i class="bi bi-facebook"></i>
</a>
<a href="https://wa.me/qr/DXZ2EVTI2BHXD1 "><i class="bi bi-whatsapp"></i>
</a>
    </div>   
     <hr>
    <div class="container-fluid">
      <h6>© 2024, Derechos Reservados por: </h6>
      <small>
        <b>Ariana Morera Castro y Sebastián Torrellas Valera</b>
      </small>
    </div>
  </footer>
    <!-- Footer fin -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-2.2.4.js" crossorigin="anonymous"></script>
  <!-- https://notifyjs.jpillora.com/-->
   <script src="./Js/notify.min.js"></script> 
<script src="./Js/ProcesoCompra.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
      // Recuperar el estado del checkbox desde localStorage
      var checkboxState = localStorage.getItem("checkboxState");
      
      // Calcular el costo total del envío y el total inicial
      var total = 0;
      var costoTotalEnvio = 0;
      var cart = JSON.parse(localStorage.getItem('compra'));
  
      // Obtener el contenedor de la tabla
      var detalle = document.getElementById('detalle');
      detalle.innerHTML = ''; // Limpiar el contenido actual de la tabla
  
      if (cart) {
          cart.forEach(function(item) {
              var nombre = item.nombre;
              var precio = parseFloat(item.precio) || 0;
              var cantidad = parseInt(item.cantidad) || 0;
              var subtotal = precio * cantidad;
              
              total += subtotal;
              costoTotalEnvio += parseFloat(item.costo) || 0; // Sumar el costo de cada artículo al costo total de envío
  
              // Crear una nueva fila
              var row = document.createElement('tr');
  
              // Crear celdas para cada valor
              var cellNombre = document.createElement('td');
              cellNombre.textContent = nombre;
              row.appendChild(cellNombre);
  
              var cellCantidad = document.createElement('td');
              cellCantidad.textContent = cantidad;
              row.appendChild(cellCantidad);
  
              var cellPrecio = document.createElement('td');
              cellPrecio.textContent = "¢" + precio.toFixed(2);
              row.appendChild(cellPrecio);
  
              var cellSubtotal = document.createElement('td');
              cellSubtotal.textContent = "¢" + subtotal.toFixed(2);
              row.appendChild(cellSubtotal);
  
              // Agregar la fila a la tabla
              detalle.appendChild(row);
          });
      }
  var  cart2=JSON.parse(localStorage.getItem('MedioDePago'))
      var tipo= cart2.tipoEnvio;
      // Verificar si el checkbox está marcado
      if (checkboxState === 'true') {
          // Sumar el costo de envío al total
          total += costoTotalEnvio;
  
          // Mostrar el costo de envío
          $('#costoEnvio').text("¢" + costoTotalEnvio.toFixed(2));
      } else {
          $('#costoEnvio').text("¢0.00");
      }
          $('#TipoEnvio').text("¢" + tipo);
      // Mostrar el total
      $('#mostrar-total').text("¢" + total.toFixed(2));
  });
  
  
  $(document).ready(function() {
      // Guardar el estado del checkbox en localStorage cuando cambia
      $('#flexCheckChecked').on('change', function() {
          localStorage.setItem("checkboxState", this.checked);
      });
  });
  </script>
  
<script>
  function limpiarCarrito() {
    localStorage.removeItem("compra");
    localStorage.removeItem("checkboxState");
  }
</script>
</body>

</html>
